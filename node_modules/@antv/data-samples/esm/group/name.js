import { __awaiter, __generator } from "tslib";
import * as ds from '../data';
function allDataEntities() {
    var dataEntities = {};
    var dsNameSpace = ds;
    Object.keys(dsNameSpace).forEach(function (dataCate) {
        // data categories: chart, story, url ...
        var set = dsNameSpace[dataCate];
        Object.keys(set).forEach(function (dsObjKey) {
            var dsObj = set[dsObjKey];
            dataEntities[dsObj.name] = dsObj;
        });
    });
    return dataEntities;
}
export var DATA_SAMPLES_BY_NAME = allDataEntities();
export function dataByName(name) {
    return __awaiter(this, void 0, void 0, function () {
        var data, entity;
        return __generator(this, function (_a) {
            switch (_a.label) {
                case 0:
                    if (!Object.keys(DATA_SAMPLES_BY_NAME).includes(name)) {
                        throw new Error("Data Sample with name ".concat(name, " is NOT FOUND."));
                    }
                    data = [];
                    entity = DATA_SAMPLES_BY_NAME[name];
                    if (!entity.data) return [3 /*break*/, 1];
                    data = entity.data;
                    return [3 /*break*/, 3];
                case 1:
                    if (!entity.url) return [3 /*break*/, 3];
                    return [4 /*yield*/, fetch(entity.url)
                            .then(function (res) { return res.json(); })
                            .then(function (urlData) {
                            data = urlData;
                        })
                            .catch(function (err) {
                            throw new Error("CAN NOT fetch Data Sample ".concat(name, " by ").concat(entity.url), { cause: err });
                        })];
                case 2:
                    _a.sent();
                    _a.label = 3;
                case 3: return [2 /*return*/, data];
            }
        });
    });
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmFtZS5qcyIsInNvdXJjZVJvb3QiOiJzcmMvIiwic291cmNlcyI6WyJncm91cC9uYW1lLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7QUFBQSxPQUFPLEtBQUssRUFBRSxNQUFNLFNBQVMsQ0FBQztBQUc5QixTQUFTLGVBQWU7SUFDdEIsSUFBTSxZQUFZLEdBQVEsRUFBRSxDQUFDO0lBQzdCLElBQU0sV0FBVyxHQUFHLEVBQVMsQ0FBQztJQUU5QixNQUFNLENBQUMsSUFBSSxDQUFDLFdBQVcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLFFBQVE7UUFDeEMseUNBQXlDO1FBQ3pDLElBQU0sR0FBRyxHQUFHLFdBQVcsQ0FBQyxRQUFRLENBQUMsQ0FBQztRQUNsQyxNQUFNLENBQUMsSUFBSSxDQUFDLEdBQUcsQ0FBQyxDQUFDLE9BQU8sQ0FBQyxVQUFDLFFBQVE7WUFDaEMsSUFBTSxLQUFLLEdBQUcsR0FBRyxDQUFDLFFBQVEsQ0FBQyxDQUFDO1lBQzVCLFlBQVksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLEdBQUcsS0FBSyxDQUFDO1FBQ25DLENBQUMsQ0FBQyxDQUFDO0lBQ0wsQ0FBQyxDQUFDLENBQUM7SUFFSCxPQUFPLFlBQVksQ0FBQztBQUN0QixDQUFDO0FBRUQsTUFBTSxDQUFDLElBQU0sb0JBQW9CLEdBQUcsZUFBZSxFQUFFLENBQUM7QUFFdEQsTUFBTSxVQUFnQixVQUFVLENBQUMsSUFBWTs7Ozs7O29CQUMzQyxJQUFJLENBQUMsTUFBTSxDQUFDLElBQUksQ0FBQyxvQkFBb0IsQ0FBQyxDQUFDLFFBQVEsQ0FBQyxJQUFJLENBQUMsRUFBRTt3QkFDckQsTUFBTSxJQUFJLEtBQUssQ0FBQyxnQ0FBeUIsSUFBSSxtQkFBZ0IsQ0FBQyxDQUFDO3FCQUNoRTtvQkFFRyxJQUFJLEdBQVMsRUFBRSxDQUFDO29CQUVkLE1BQU0sR0FBRyxvQkFBb0IsQ0FBQyxJQUFJLENBQUMsQ0FBQzt5QkFFdEMsTUFBTSxDQUFDLElBQUksRUFBWCx3QkFBVztvQkFDYixJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQzs7O3lCQUNWLE1BQU0sQ0FBQyxHQUFHLEVBQVYsd0JBQVU7b0JBQ25CLHFCQUFNLEtBQUssQ0FBQyxNQUFNLENBQUMsR0FBRyxDQUFDOzZCQUNwQixJQUFJLENBQUMsVUFBQyxHQUFHLElBQUssT0FBQSxHQUFHLENBQUMsSUFBSSxFQUFFLEVBQVYsQ0FBVSxDQUFDOzZCQUN6QixJQUFJLENBQUMsVUFBQyxPQUFPOzRCQUNaLElBQUksR0FBRyxPQUFPLENBQUM7d0JBQ2pCLENBQUMsQ0FBQzs2QkFDRCxLQUFLLENBQUMsVUFBQyxHQUFHOzRCQUNULE1BQU0sSUFBSSxLQUFLLENBQUMsb0NBQTZCLElBQUksaUJBQU8sTUFBTSxDQUFDLEdBQUcsQ0FBRSxFQUFFLEVBQUUsS0FBSyxFQUFFLEdBQUcsRUFBRSxDQUFDLENBQUM7d0JBQ3hGLENBQUMsQ0FBQyxFQUFBOztvQkFQSixTQU9JLENBQUM7O3dCQUdQLHNCQUFPLElBQUksRUFBQzs7OztDQUNiIn0=