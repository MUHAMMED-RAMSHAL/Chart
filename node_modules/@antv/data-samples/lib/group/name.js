"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.dataByName = exports.DATA_SAMPLES_BY_NAME = void 0;
var tslib_1 = require("tslib");
var ds = tslib_1.__importStar(require("../data"));
function allDataEntities() {
    var dataEntities = {};
    var dsNameSpace = ds;
    Object.keys(dsNameSpace).forEach(function (dataCate) {
        // data categories: chart, story, url ...
        var set = dsNameSpace[dataCate];
        Object.keys(set).forEach(function (dsObjKey) {
            var dsObj = set[dsObjKey];
            dataEntities[dsObj.name] = dsObj;
        });
    });
    return dataEntities;
}
exports.DATA_SAMPLES_BY_NAME = allDataEntities();
function dataByName(name) {
    return tslib_1.__awaiter(this, void 0, void 0, function () {
        var data, entity;
        return tslib_1.__generator(this, function (_a) {
            switch (_a.label) {
                case 0:
                    if (!Object.keys(exports.DATA_SAMPLES_BY_NAME).includes(name)) {
                        throw new Error("Data Sample with name ".concat(name, " is NOT FOUND."));
                    }
                    data = [];
                    entity = exports.DATA_SAMPLES_BY_NAME[name];
                    if (!entity.data) return [3 /*break*/, 1];
                    data = entity.data;
                    return [3 /*break*/, 3];
                case 1:
                    if (!entity.url) return [3 /*break*/, 3];
                    return [4 /*yield*/, fetch(entity.url)
                            .then(function (res) { return res.json(); })
                            .then(function (urlData) {
                            data = urlData;
                        })
                            .catch(function (err) {
                            throw new Error("CAN NOT fetch Data Sample ".concat(name, " by ").concat(entity.url), { cause: err });
                        })];
                case 2:
                    _a.sent();
                    _a.label = 3;
                case 3: return [2 /*return*/, data];
            }
        });
    });
}
exports.dataByName = dataByName;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibmFtZS5qcyIsInNvdXJjZVJvb3QiOiJzcmMvIiwic291cmNlcyI6WyJncm91cC9uYW1lLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiI7Ozs7QUFBQSxrREFBOEI7QUFHOUIsU0FBUyxlQUFlO0lBQ3RCLElBQU0sWUFBWSxHQUFRLEVBQUUsQ0FBQztJQUM3QixJQUFNLFdBQVcsR0FBRyxFQUFTLENBQUM7SUFFOUIsTUFBTSxDQUFDLElBQUksQ0FBQyxXQUFXLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQyxRQUFRO1FBQ3hDLHlDQUF5QztRQUN6QyxJQUFNLEdBQUcsR0FBRyxXQUFXLENBQUMsUUFBUSxDQUFDLENBQUM7UUFDbEMsTUFBTSxDQUFDLElBQUksQ0FBQyxHQUFHLENBQUMsQ0FBQyxPQUFPLENBQUMsVUFBQyxRQUFRO1lBQ2hDLElBQU0sS0FBSyxHQUFHLEdBQUcsQ0FBQyxRQUFRLENBQUMsQ0FBQztZQUM1QixZQUFZLENBQUMsS0FBSyxDQUFDLElBQUksQ0FBQyxHQUFHLEtBQUssQ0FBQztRQUNuQyxDQUFDLENBQUMsQ0FBQztJQUNMLENBQUMsQ0FBQyxDQUFDO0lBRUgsT0FBTyxZQUFZLENBQUM7QUFDdEIsQ0FBQztBQUVZLFFBQUEsb0JBQW9CLEdBQUcsZUFBZSxFQUFFLENBQUM7QUFFdEQsU0FBc0IsVUFBVSxDQUFDLElBQVk7Ozs7OztvQkFDM0MsSUFBSSxDQUFDLE1BQU0sQ0FBQyxJQUFJLENBQUMsNEJBQW9CLENBQUMsQ0FBQyxRQUFRLENBQUMsSUFBSSxDQUFDLEVBQUU7d0JBQ3JELE1BQU0sSUFBSSxLQUFLLENBQUMsZ0NBQXlCLElBQUksbUJBQWdCLENBQUMsQ0FBQztxQkFDaEU7b0JBRUcsSUFBSSxHQUFTLEVBQUUsQ0FBQztvQkFFZCxNQUFNLEdBQUcsNEJBQW9CLENBQUMsSUFBSSxDQUFDLENBQUM7eUJBRXRDLE1BQU0sQ0FBQyxJQUFJLEVBQVgsd0JBQVc7b0JBQ2IsSUFBSSxHQUFHLE1BQU0sQ0FBQyxJQUFJLENBQUM7Ozt5QkFDVixNQUFNLENBQUMsR0FBRyxFQUFWLHdCQUFVO29CQUNuQixxQkFBTSxLQUFLLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQzs2QkFDcEIsSUFBSSxDQUFDLFVBQUMsR0FBRyxJQUFLLE9BQUEsR0FBRyxDQUFDLElBQUksRUFBRSxFQUFWLENBQVUsQ0FBQzs2QkFDekIsSUFBSSxDQUFDLFVBQUMsT0FBTzs0QkFDWixJQUFJLEdBQUcsT0FBTyxDQUFDO3dCQUNqQixDQUFDLENBQUM7NkJBQ0QsS0FBSyxDQUFDLFVBQUMsR0FBRzs0QkFDVCxNQUFNLElBQUksS0FBSyxDQUFDLG9DQUE2QixJQUFJLGlCQUFPLE1BQU0sQ0FBQyxHQUFHLENBQUUsRUFBRSxFQUFFLEtBQUssRUFBRSxHQUFHLEVBQUUsQ0FBQyxDQUFDO3dCQUN4RixDQUFDLENBQUMsRUFBQTs7b0JBUEosU0FPSSxDQUFDOzt3QkFHUCxzQkFBTyxJQUFJLEVBQUM7Ozs7Q0FDYjtBQXZCRCxnQ0F1QkMifQ==